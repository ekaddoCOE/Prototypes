<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>COE Outreach Workflow</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --aggie-blue: #022761;
      --aggie-blue-dark: #002d74;
      --aggie-gold: #fdb827;
      --gray-100: #f5f5f5;
      --gray-200: #e8e8e8;
      --gray-400: #71757d;
      --gray-700: #46474a;
      --green-600: #16a34a;
      --blue-600: #2563eb;
      --orange-600: #ea580c;
      --red-600: #dc2626;
      --radius-sm: 4px;
      --radius-md: 8px;
      --shadow-soft: 0 2px 6px rgba(0, 0, 0, 0.06);
    }

    *,
    *::before,
    *::after {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: "Montserrat", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background-color: #ffffff;
      color: var(--gray-700);
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 32px;
      background-color: var(--aggie-blue);
      color: #ffffff;
    }

    .top-bar-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .logo-box {
      background-color: var(--aggie-gold);
      border-radius: var(--radius-sm);
      padding: 8px 12px;
      font-weight: 700;
      color: var(--aggie-blue-dark);
      box-shadow: var(--shadow-soft);
    }

    .top-title-primary {
      font-weight: 600;
      font-size: 16px;
    }

    .top-title-secondary {
      font-size: 12px;
      opacity: 0.9;
    }

    .top-bar-right {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .pill-button,
    .pill-primary,
    .pill-secondary {
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-size: 12px;
      padding: 6px 14px;
      font-weight: 500;
    }

    .pill-button {
      background-color: #ffffff;
      color: var(--aggie-blue);
    }

    .pill-button.pill-toggle.active {
      background-color: var(--aggie-gold);
      color: var(--aggie-blue-dark);
    }

    .pill-secondary {
      background-color: transparent;
      border: 1px solid #ffffff;
      color: #ffffff;
    }

    .pill-primary {
      background-color: var(--aggie-gold);
      color: var(--aggie-blue-dark);
    }

    .nav-tabs {
      display: flex;
      gap: 2px;
      padding: 0 32px;
      background-color: #ffffff;
      border-bottom: 1px solid var(--gray-200);
      flex-wrap: wrap;
    }

    .nav-tab {
      padding: 12px 16px;
      font-size: 13px;
      text-decoration: none;
      color: var(--gray-700);
      border-bottom: 3px solid transparent;
      cursor: pointer;
      background: none;
      border: none;
    }

    .nav-tab.active {
      border-bottom-color: var(--aggie-gold);
      font-weight: 600;
    }

    .nav-tab.disabled {
      color: var(--gray-400);
      pointer-events: none;
    }

    .page-main {
      padding: 24px 32px 40px;
      background-color: var(--gray-100);
      min-height: calc(100vh - 96px);
    }

    .card {
      background-color: #ffffff;
      border-radius: 12px;
      padding: 24px;
      box-shadow: var(--shadow-soft);
      margin-bottom: 24px;
    }

    .card-title {
      margin: 0 0 20px;
      font-size: 20px;
      color: var(--aggie-blue-dark);
    }

    .subheading {
      font-size: 14px;
      margin: 20px 0 12px;
      color: var(--aggie-blue-dark);
      font-weight: 600;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px 24px;
    }

    .form-field {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .form-field-full {
      grid-column: 1 / -1;
    }

    label {
      font-weight: 600;
      color: var(--gray-700);
    }

    input,
    select,
    textarea {
      border-radius: 6px;
      border: 1px solid var(--gray-200);
      padding: 8px 10px;
      font-size: 13px;
      font-family: inherit;
    }

    input:focus,
    select:focus,
    textarea:focus {
      outline: 2px solid var(--aggie-gold);
      border-color: var(--aggie-gold);
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .chip {
      border-radius: 999px;
      border: 1px solid var(--gray-200);
      background-color: #fff;
      padding: 4px 10px;
      font-size: 12px;
      cursor: pointer;
    }

    .chip.active {
      background-color: var(--aggie-blue);
      border-color: var(--aggie-blue);
      color: #fff;
    }

    .primary-btn,
    .secondary-btn {
      border-radius: 6px;
      border: none;
      padding: 8px 18px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
    }

    .primary-btn {
      background-color: var(--aggie-gold);
      color: var(--aggie-blue-dark);
    }

    .primary-btn.small {
      padding: 6px 12px;
      font-size: 12px;
    }

    .secondary-btn {
      background-color: #fff;
      color: var(--aggie-blue-dark);
      border: 1px solid var(--gray-200);
    }

    .secondary-btn.small {
      padding: 6px 12px;
      font-size: 12px;
    }

    .card-footer {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-top: 20px;
    }

    .card-footer-note {
      font-size: 12px;
      color: var(--gray-400);
    }

    .card-footer-note a {
      color: var(--aggie-blue);
      text-decoration: none;
    }

    .queue-filters {
      display: flex;
      gap: 12px;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }

    .table-container {
      overflow-x: auto;
      margin-top: 12px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
    }

    thead {
      background-color: var(--gray-100);
    }

    th,
    td {
      padding: 8px 10px;
      border-bottom: 1px solid var(--gray-200);
      text-align: left;
    }

    tbody tr:hover {
      background-color: #fafafa;
    }

    .responses-layout {
      display: grid;
      grid-template-columns: 280px 1fr;
      gap: 24px;
    }

    .request-list {
      list-style: none;
      padding: 0;
      margin: 0;
      border: 1px solid var(--gray-200);
      border-radius: 8px;
      max-height: 520px;
      overflow-y: auto;
    }

    .request-list-item {
      padding: 10px 12px;
      border-bottom: 1px solid var(--gray-200);
      cursor: pointer;
    }

    .request-list-item.active {
      background-color: var(--gray-100);
      border-left: 4px solid var(--aggie-gold);
    }

    .request-title {
      font-size: 13px;
      font-weight: 600;
      color: var(--aggie-blue-dark);
    }

    .request-meta {
      font-size: 11px;
      color: var(--gray-400);
      margin-top: 2px;
    }

    .detail-row {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid var(--gray-200);
      font-size: 13px;
    }

    .detail-label {
      font-weight: 600;
      color: var(--aggie-blue-dark);
    }

    .detail-actions {
      display: flex;
      gap: 8px;
      margin-top: 16px;
    }

    .history-list {
      list-style: none;
      padding: 0;
      margin: 0 0 16px 0;
    }

    .history-list li {
      padding: 8px;
      background-color: var(--gray-100);
      border-radius: 6px;
      margin-bottom: 8px;
      font-size: 12px;
    }

    .history-list strong {
      display: block;
      color: var(--aggie-blue-dark);
    }

    .history-list em {
      color: var(--gray-400);
    }

    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }

    .metric-card {
      background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);
      border: 1px solid var(--gray-200);
      border-radius: 8px;
      padding: 16px;
      text-align: center;
    }

    .metric-value {
      font-size: 32px;
      font-weight: 700;
      color: var(--aggie-blue-dark);
      margin: 8px 0;
    }

    .metric-label {
      font-size: 12px;
      color: var(--gray-400);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .metric-change {
      font-size: 12px;
      margin-top: 8px;
    }

    .metric-change.positive {
      color: var(--green-600);
    }

    .chart-container {
      background: #ffffff;
      border: 1px solid var(--gray-200);
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
    }

    .chart-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 12px;
      color: var(--gray-700);
    }

    .bar-chart {
      display: flex;
      gap: 12px;
      align-items: flex-end;
      justify-content: space-around;
      height: 200px;
      margin: 12px 0;
    }

    .bar {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      flex: 1;
    }

    .bar-fill {
      width: 100%;
      background: linear-gradient(180deg, var(--aggie-blue) 0%, var(--aggie-blue-dark) 100%);
      border-radius: 4px 4px 0 0;
      position: relative;
      min-width: 30px;
    }

    .bar-label {
      font-size: 11px;
      text-align: center;
      color: var(--gray-400);
      width: 100%;
    }

    .bar-value {
      font-size: 12px;
      font-weight: 600;
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      color: var(--gray-700);
    }

    .export-btn {
      background-color: var(--aggie-gold);
      color: var(--aggie-blue-dark);
      border-radius: 6px;
      border: none;
      padding: 8px 16px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 12px;
    }

    .export-btn:hover {
      opacity: 0.9;
    }

    .date-range {
      display: flex;
      gap: 12px;
      margin-bottom: 16px;
      align-items: center;
      flex-wrap: wrap;
    }

    .date-range input {
      border-radius: 6px;
      border: 1px solid var(--gray-200);
      padding: 6px 8px;
      font-size: 12px;
    }

    .date-range button {
      background-color: var(--aggie-blue);
      color: #ffffff;
      border-radius: 6px;
      border: none;
      padding: 6px 12px;
      font-size: 12px;
      cursor: pointer;
    }

    .status-active {
      background-color: #d1fae5;
      color: #065f46;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 600;
    }

    .status-pill {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 600;
    }

    .status-pill.status-new {
      background-color: #fef3c7;
      color: #92400e;
    }

    .status-pill.status-assigned {
      background-color: #dbeafe;
      color: #0c4a6e;
    }

    .status-pill.status-in-progress {
      background-color: #cffafe;
      color: #164e63;
    }

    .status-pill.status-completed {
      background-color: #dcfce7;
      color: #166534;
    }

    .hidden {
      display: none;
    }

    .muted-text {
      color: var(--gray-400);
      font-size: 13px;
    }

    @media (max-width: 768px) {
      .form-grid {
        grid-template-columns: 1fr;
      }

      .responses-layout {
        grid-template-columns: 1fr;
      }

      .nav-tabs {
        padding: 0 12px;
      }

      .page-main {
        padding: 16px 12px;
      }

      .card {
        padding: 16px;
      }

      .top-bar {
        padding: 12px 16px;
        flex-direction: column;
        gap: 8px;
        text-align: center;
      }
    }
  </style>
</head>
<body>
  <header class="top-bar">
    <div class="top-bar-left">
      <div class="logo-box"><span class="logo-mark">A&T</span></div>
      <div class="top-title">
        <div class="top-title-primary">College of Engineering – Outreach Workflow</div>
        <div class="top-title-secondary">Request intake, assignment, response logging & surveys</div>
      </div>
    </div>
    <div class="top-bar-right">
      <button class="pill-button pill-toggle active">EN</button>
      <button class="pill-button">ES</button>
      <button class="pill-secondary">Help</button>
      <button class="pill-primary">Send to Dr. Bennett</button>
    </div>
  </header>

  <nav class="nav-tabs">
    <button class="nav-tab active" data-page="intake">Request Intake</button>
    <button class="nav-tab" data-page="queue">Queue & Assignment</button>
    <button class="nav-tab" data-page="responses">Responses & Artifacts</button>
    <button class="nav-tab" data-page="analytics">Surveys & Reporting</button>
    <button class="nav-tab" data-page="admin">Admin & Program Tags</button>
  </nav>

  <main class="page-main" id="pageContent"></main>

  <script>
    const dummyRequests = [
      {id:"REQ-001",requester:"Ms. Jordan Lee",email:"jlee@triadms.org",organization:"Triad Middle School",engagement:"Workshop",department:"MEEN",preferredDate:"2025-03-14",status:"completed",assignedTo:"Dr. Marcus Johnson",responses:[{date:"2025-01-05",by:"Dr. Marcus Johnson",text:"Initial contact confirmed."},{date:"2025-02-10",by:"Dr. Marcus Johnson",text:"Workshop materials prepared."},{date:"2025-03-15",by:"Dr. Marcus Johnson",text:"Workshop completed successfully."}],survey:{status:"Completed",score:4.8}},
      {id:"REQ-002",requester:"Dr. Malik Carter",email:"mcarter@citystem.org",organization:"City STEM Nonprofit",engagement:"Campus tour",department:"CS",preferredDate:"2025-04-02",status:"in-progress",assignedTo:"Dr. Patricia Wong",responses:[{date:"2025-01-08",by:"Dr. Patricia Wong",text:"Tour date confirmed."},{date:"2025-03-20",by:"Dr. Patricia Wong",text:"Lab preparations underway."}],survey:{status:"Pending"}},
      {id:"REQ-003",requester:"Coach Ana Rivera",email:"arivera@firstteam.net",organization:"FIRST Robotics Team 9876",engagement:"Competition support",department:"ECE",preferredDate:"2025-02-21",status:"completed",assignedTo:"Prof. Angela Williams",responses:[{date:"2025-01-02",by:"Prof. Angela Williams",text:"Confirmed volunteer mentors."},{date:"2025-02-25",by:"Prof. Angela Williams",text:"Event completed, 5 students mentored."}],survey:{status:"Completed",score:4.9}},
      {id:"REQ-004",requester:"Mr. Kevin Torres",email:"ktorres@highschooltech.edu",organization:"Lincoln High School",engagement:"Lab demo",department:"CDSE",preferredDate:"2025-04-10",status:"in-progress",assignedTo:"Dr. David Kim",responses:[{date:"2025-01-12",by:"Dr. David Kim",text:"Lab demo confirmed."}],survey:{status:"Pending"}},
      {id:"REQ-005",requester:"Dr. Patricia Brown",email:"pbrown@enviro-nonprofit.org",organization:"Environmental Solutions Alliance",engagement:"Guest speaker",department:"CAEE",preferredDate:"2025-03-28",status:"completed",assignedTo:"Prof. Tamara Lewis",responses:[{date:"2025-01-15",by:"Prof. Tamara Lewis",text:"Speaker confirmed."},{date:"2025-03-29",by:"Prof. Tamara Lewis",text:"Talk delivered, 60 attendees."}],survey:{status:"Completed",score:4.6}},
      {id:"REQ-006",requester:"Ms. Sarah Johnson",email:"sjohnson@stem4girls.org",organization:"STEM4Girls Initiative",engagement:"Workshop",department:"CBBE",preferredDate:"2025-04-15",status:"assigned",assignedTo:"Dr. Elena Rodriguez",responses:[{date:"2025-01-18",by:"Dr. Elena Rodriguez",text:"Workshop outline sent for review."}],survey:{status:"Pending"}},
      {id:"REQ-007",requester:"Mr. James Wilson",email:"jwilson@industrial.com",organization:"Precision Manufacturing Inc.",engagement:"Competition support",department:"ISE",preferredDate:"2025-05-10",status:"assigned",assignedTo:"Dr. Christopher Lee",responses:[],survey:{status:"Not sent"}},
      {id:"REQ-008",requester:"Dr. Lisa Anderson",email:"landerson@ag-university.edu",organization:"Agricultural Tech Research Center",engagement:"Campus tour",department:"CBBE",preferredDate:"2025-03-05",status:"completed",assignedTo:"Dr. Elena Rodriguez",responses:[{date:"2025-01-20",by:"Dr. Elena Rodriguez",text:"Tour scheduled with grad students."},{date:"2025-03-06",by:"Dr. Elena Rodriguez",text:"Successful tour, 12 faculty attendees."}],survey:{status:"Completed",score:4.7}},
      {id:"REQ-009",requester:"Mr. Derek Phillips",email:"dphillips@youths-org.net",organization:"Youth Innovation Hub",engagement:"Workshop",department:"ECE",preferredDate:"2025-04-22",status:"in-progress",assignedTo:"Prof. Angela Williams",responses:[{date:"2025-01-22",by:"Prof. Angela Williams",text:"Materials prepared, facility booked."}],survey:{status:"Pending"}},
      {id:"REQ-010",requester:"Ms. Claudia Martinez",email:"cmartinez@codewitchcraft.com",organization:"Code Witchcraft (Non-profit)",engagement:"Lab demo",department:"CS",preferredDate:"2025-05-08",status:"new",assignedTo:"",responses:[],survey:{status:"Not sent"}},
      {id:"REQ-011",requester:"Mr. Robert Thompson",email:"rthompson@manufacturing.edu",organization:"Technical Institute Partnership",engagement:"Workshop",department:"MEEN",preferredDate:"2025-04-08",status:"completed",assignedTo:"Dr. Marcus Johnson",responses:[{date:"2025-01-25",by:"Dr. Marcus Johnson",text:"Workshop confirmed with technical team."},{date:"2025-04-09",by:"Dr. Marcus Johnson",text:"Successful delivery to 40 students."}],survey:{status:"Completed",score:4.5}},
      {id:"REQ-012",requester:"Dr. Monica Patel",email:"mpatel@datascienceacademy.org",organization:"Data Science Academy",engagement:"Lab demo",department:"CDSE",preferredDate:"2025-05-01",status:"in-progress",assignedTo:"Dr. David Kim",responses:[{date:"2025-02-01",by:"Dr. David Kim",text:"Big data pipeline demo setup underway."}],survey:{status:"Pending"}}
    ];

    const deptMap = {"MEEN":"Mechanical Engineering (MEEN)","ECE":"Electrical & Computer Engineering (ECE)","CS":"Computer Science (CS)","CDSE":"Computational Data Science & Engineering (CDSE)","CAEE":"Civil, Arch. & Environmental Engineering (CAEE)","CBBE":"Chemical, Biological & Bio Engineering (CBBE)","ISE":"Industrial & Systems Engineering (ISE)"};

    const managers = {MEEN:{name:"Dr. Marcus Johnson",email:"mjohnson@ncat.edu",phone:"(336) 334-7501"},ECE:{name:"Prof. Angela Williams",email:"awilliams@ncat.edu",phone:"(336) 334-7502"},CS:{name:"Dr. Patricia Wong",email:"pwong@ncat.edu",phone:"(336) 334-7503"},CDSE:{name:"Dr. David Kim",email:"dkim@ncat.edu",phone:"(336) 334-7504"},CAEE:{name:"Prof. Tamara Lewis",email:"tlewis@ncat.edu",phone:"(336) 334-7505"},CBBE:{name:"Dr. Elena Rodriguez",email:"erodriguez@ncat.edu",phone:"(336) 334-7506"},ISE:{name:"Dr. Christopher Lee",email:"clee@ncat.edu",phone:"(336) 334-7507"}};

    function renderPage(pageType) {
      const content = document.getElementById("pageContent");
      content.innerHTML = "";

      if (pageType === "intake") {
        content.innerHTML = `
          <section class="card">
            <h1 class="card-title">External Request Intake</h1>
            <form id="intakeForm" class="form-grid">
              <div class="form-field">
                <label for="requesterName">Requester Name</label>
                <input type="text" id="requesterName" placeholder="Full name" required />
              </div>
              <div class="form-field">
                <label for="requesterEmail">Requester Email</label>
                <input type="email" id="requesterEmail" placeholder="name@example.org" required />
              </div>
              <div class="form-field">
                <label for="organization">Organization</label>
                <input type="text" id="organization" placeholder="School, nonprofit, company" />
              </div>
              <div class="form-field">
                <label for="engagementType">Engagement Type</label>
                <select id="engagementType">
                  <option>Workshop</option>
                  <option>School visit</option>
                  <option>Campus tour</option>
                  <option>Competition support</option>
                  <option>Guest speaker</option>
                  <option>Lab demo</option>
                </select>
              </div>
              <div class="form-field">
                <label for="department">Department Focus</label>
                <select id="department" required>
                  <option value="">--Select Department--</option>
                  <option value="MEEN">Mechanical Engineering (MEEN)</option>
                  <option value="ECE">Electrical & Computer Engineering (ECE)</option>
                  <option value="CS">Computer Science (CS)</option>
                  <option value="CDSE">Computational Data Science & Engineering (CDSE)</option>
                  <option value="CAEE">Civil, Architectural & Environmental Engineering (CAEE)</option>
                  <option value="CBBE">Chemical, Biological & Bio Engineering (CBBE)</option>
                  <option value="ISE">Industrial & Systems Engineering (ISE)</option>
                </select>
              </div>
              <div class="form-field">
                <label for="preferredDate">Preferred Date</label>
                <input type="date" id="preferredDate" />
              </div>
              <div class="form-field">
                <label>Special Needs</label>
                <div class="chip-row">
                  <button type="button" class="chip" data-chip="access">Access</button>
                  <button type="button" class="chip" data-chip="translation">Translation</button>
                  <button type="button" class="chip" data-chip="equipment">Equipment</button>
                </div>
              </div>
              <div class="form-field form-field-full">
                <label for="notes">Notes</label>
                <textarea id="notes" rows="4" placeholder="Additional context"></textarea>
              </div>
            </form>
            <footer class="card-footer">
              <button id="submitIntake" class="primary-btn">Submit</button>
              <div class="card-footer-note">
                <a href="https://www.ncat.edu/coe/outreach/index.php" target="_blank" rel="noreferrer">COE Outreach page</a>
              </div>
            </footer>
          </section>
        `;
        initIntakePage();
      } else if (pageType === "queue") {
        content.innerHTML = `
          <section class="card">
            <h1 class="card-title">Request Queue</h1>
            <div class="queue-filters">
              <select id="filterStatus">
                <option value="all">All statuses</option>
                <option value="new">New</option>
                <option value="assigned">Assigned</option>
                <option value="in-progress">In Progress</option>
                <option value="completed">Completed</option>
              </select>
              <select id="filterDepartment">
                <option value="all">All departments</option>
                <option value="MEEN">Mechanical Engineering</option>
                <option value="ECE">Electrical & Computer Eng.</option>
                <option value="CS">Computer Science</option>
                <option value="CDSE">Computational Data Science</option>
                <option value="CAEE">Civil, Arch., & Environmental</option>
                <option value="CBBE">Chemical, Bio., & Bio Eng.</option>
                <option value="ISE">Industrial & Systems Eng.</option>
              </select>
              <select id="filterEngagement">
                <option value="all">All engagement types</option>
                <option value="Workshop">Workshop</option>
                <option value="Campus tour">Campus tour</option>
                <option value="Competition support">Competition support</option>
                <option value="School visit">School visit</option>
              </select>
            </div>
            <table class="data-table" id="queueTable">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Requester</th>
                  <th>Organization</th>
                  <th>Engagement</th>
                  <th>Department</th>
                  <th>Status</th>
                  <th>Assigned To</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </section>
        `;
        initQueuePage();
      } else if (pageType === "responses") {
        content.innerHTML = `
          <section class="card">
            <h1 class="card-title">Responses & Artifacts</h1>
            <div class="responses-layout">
              <div class="responses-list">
                <h2 class="subheading">Requests</h2>
                <ul id="responseRequestList" class="request-list"></ul>
              </div>
              <div class="responses-detail">
                <h2 class="subheading">Details</h2>
                <div id="responseDetailEmpty" class="muted-text">Select a request to view response history and survey status.</div>
                <div id="responseDetail" class="hidden">
                  <div class="detail-row"><span class="detail-label">Requester</span><span id="detailRequester"></span></div>
                  <div class="detail-row"><span class="detail-label">Engagement</span><span id="detailEngagement"></span></div>
                  <div class="detail-row"><span class="detail-label">Department</span><span id="detailDept"></span></div>
                  <div class="detail-row"><span class="detail-label">Assigned To</span><span id="detailAssigned"></span></div>
                  <div class="detail-row"><span class="detail-label">Status</span><span id="detailStatus"></span></div>
                  <h3 class="subheading">Logged Responses</h3>
                  <ul id="detailResponses" class="history-list"></ul>
                  <h3 class="subheading">Survey</h3>
                  <div id="detailSurvey"></div>
                  <div class="detail-actions">
                    <button class="primary-btn small">Add Response</button>
                    <button class="secondary-btn small">Upload Artifact</button>
                  </div>
                </div>
              </div>
            </div>
          </section>
        `;
        initResponsesPage();
      } else if (pageType === "analytics") {
        content.innerHTML = `
          <section class="card">
            <h1 class="card-title">Surveys & Reporting Dashboard</h1>
            <div class="date-range">
              <label>Date Range:</label>
              <input type="date" id="startDate" value="2024-01-01" />
              <input type="date" id="endDate" value="2025-12-30" />
              <button onclick="refreshAnalytics()">Apply</button>
            </div>
            <h2 class="subheading">College of Engineering Overall Metrics</h2>
            <div class="metrics-grid">
              <div class="metric-card">
                <div class="metric-label">Total Requests</div>
                <div class="metric-value">48</div>
                <div class="metric-change positive">↑ 12 this year</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">Completion Rate</div>
                <div class="metric-value">80%</div>
                <div class="metric-change positive">↑ 8% vs. last year</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">Avg. Response Time</div>
                <div class="metric-value">2.8</div>
                <div class="metric-change positive">↓ 1.2 days faster</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">Satisfaction Score</div>
                <div class="metric-value">4.7</div>
                <div class="metric-change positive">↑ 0.3 points</div>
              </div>
            </div>
          </section>

          <section class="card">
            <h2 class="card-title">Department Summary (All 7 COE Departments)</h2>
            <div class="table-container">
              <table>
                <thead>
                  <tr><th>Department</th><th>Total</th><th>Completed</th><th>In Progress</th><th>Completion %</th><th>Avg. Satisfaction</th></tr>
                </thead>
                <tbody>
                  <tr><td><strong>Mechanical Engineering (MEEN)</strong></td><td>8</td><td>7</td><td>1</td><td>88%</td><td>4.8/5.0</td></tr>
                  <tr><td><strong>Electrical & Computer Engineering (ECE)</strong></td><td>7</td><td>5</td><td>2</td><td>71%</td><td>4.6/5.0</td></tr>
                  <tr><td><strong>Computer Science (CS)</strong></td><td>7</td><td>6</td><td>1</td><td>86%</td><td>4.7/5.0</td></tr>
                  <tr><td><strong>Computational Data Science & Eng. (CDSE)</strong></td><td>6</td><td>5</td><td>1</td><td>83%</td><td>4.7/5.0</td></tr>
                  <tr><td><strong>Civil, Arch. & Environmental Eng. (CAEE)</strong></td><td>8</td><td>7</td><td>1</td><td>88%</td><td>4.8/5.0</td></tr>
                  <tr><td><strong>Chemical, Biological & Bio Eng. (CBBE)</strong></td><td>7</td><td>6</td><td>1</td><td>86%</td><td>4.7/5.0</td></tr>
                  <tr><td><strong>Industrial & Systems Engineering (ISE)</strong></td><td>4</td><td>2</td><td>2</td><td>50%</td><td>4.5/5.0</td></tr>
                </tbody>
              </table>
            </div>
          </section>

          <section class="card">
            <h2 class="card-title">Monthly Request Trend (2025)</h2>
            <div class="chart-container">
              <div class="chart-title">Requests Submitted by Month</div>
              <div class="bar-chart">
                <div class="bar"><div class="bar-fill" style="height: 120px;"><div class="bar-value">8</div></div><div class="bar-label">Jan</div></div>
                <div class="bar"><div class="bar-fill" style="height: 135px;"><div class="bar-value">9</div></div><div class="bar-label">Feb</div></div>
                <div class="bar"><div class="bar-fill" style="height: 180px;"><div class="bar-value">12</div></div><div class="bar-label">Mar</div></div>
                <div class="bar"><div class="bar-fill" style="height: 105px;"><div class="bar-value">7</div></div><div class="bar-label">Apr</div></div>
                <div class="bar"><div class="bar-fill" style="height: 75px;"><div class="bar-value">5</div></div><div class="bar-label">May</div></div>
                <div class="bar"><div class="bar-fill" style="height: 90px;"><div class="bar-value">6</div></div><div class="bar-label">Jun (Proj)</div></div>
              </div>
            </div>
            <button class="export-btn" onclick="exportReport()">Export as PDF</button>
          </section>
        `;
      } else if (pageType === "admin") {
        content.innerHTML = `
          <section class="card">
            <h1 class="card-title">Administration & Program Tags</h1>

            <h2 class="subheading">Department Managers (All 7 COE Departments)</h2>
            <div class="table-container">
              <table>
                <thead>
                  <tr><th>Department</th><th>Manager Name</th><th>Email</th><th>Phone</th><th>Status</th></tr>
                </thead>
                <tbody>
                  <tr><td><strong>Mechanical Engineering (MEEN)</strong></td><td>Dr. Marcus Johnson</td><td>mjohnson@ncat.edu</td><td>(336) 334-7501</td><td><span class="status-active">Active</span></td></tr>
                  <tr><td><strong>Electrical & Computer Engineering (ECE)</strong></td><td>Prof. Angela Williams</td><td>awilliams@ncat.edu</td><td>(336) 334-7502</td><td><span class="status-active">Active</span></td></tr>
                  <tr><td><strong>Computer Science (CS)</strong></td><td>Dr. Patricia Wong</td><td>pwong@ncat.edu</td><td>(336) 334-7503</td><td><span class="status-active">Active</span></td></tr>
                  <tr><td><strong>Computational Data Science & Eng. (CDSE)</strong></td><td>Dr. David Kim</td><td>dkim@ncat.edu</td><td>(336) 334-7504</td><td><span class="status-active">Active</span></td></tr>
                  <tr><td><strong>Civil, Arch. & Environmental Eng. (CAEE)</strong></td><td>Prof. Tamara Lewis</td><td>tlewis@ncat.edu</td><td>(336) 334-7505</td><td><span class="status-active">Active</span></td></tr>
                  <tr><td><strong>Chemical, Biological & Bio Eng. (CBBE)</strong></td><td>Dr. Elena Rodriguez</td><td>erodriguez@ncat.edu</td><td>(336) 334-7506</td><td><span class="status-active">Active</span></td></tr>
                  <tr><td><strong>Industrial & Systems Engineering (ISE)</strong></td><td>Dr. Christopher Lee</td><td>clee@ncat.edu</td><td>(336) 334-7507</td><td><span class="status-active">Active</span></td></tr>
                </tbody>
              </table>
            </div>

            <h2 class="subheading" style="margin-top: 32px;">Program Tags & Categories</h2>
            <div class="table-container">
              <table>
                <thead>
                  <tr><th>Program Tag</th><th>Description</th><th>Departments</th><th>Status</th></tr>
                </thead>
                <tbody>
                  <tr><td><strong>FIRST Robotics</strong></td><td>FIRST League Challenge, Tech Challenge support</td><td>MEEN, ECE, CS, CDSE</td><td><span class="status-active">Active</span></td></tr>
                  <tr><td><strong>STEM Workshop</strong></td><td>K-12 hands-on STEM learning sessions</td><td>All Departments</td><td><span class="status-active">Active</span></td></tr>
                  <tr><td><strong>Campus Research Tours</strong></td><td>Guided tours of engineering labs and facilities</td><td>All Departments</td><td><span class="status-active">Active</span></td></tr>
                  <tr><td><strong>Underrepresented Minorities</strong></td><td>Targeted outreach to URM populations in STEM</td><td>All Departments</td><td><span class="status-active">Active</span></td></tr>
                  <tr><td><strong>Industry Partnership</strong></td><td>Joint industry-academia engagement events</td><td>MEEN, ECE, ISE, CAEE</td><td><span class="status-active">Active</span></td></tr>
                  <tr><td><strong>Renewable Energy & Sustainability</strong></td><td>Clean energy, sustainable engineering focus</td><td>MEEN, CAEE, CBBE</td><td><span class="status-active">Active</span></td></tr>
                  <tr><td><strong>AI & Machine Learning</strong></td><td>Artificial intelligence and data science career exploration</td><td>CS, CDSE, ECE</td><td><span class="status-active">Active</span></td></tr>
                  <tr><td><strong>Women in Engineering</strong></td><td>Career pathways and mentorship for women engineers</td><td>All Departments</td><td><span class="status-active">Active</span></td></tr>
                </tbody>
              </table>
            </div>
          </section>
        `;
      }
    }

    function initIntakePage() {
      const chipButtons = document.querySelectorAll(".chip");
      const submitBtn = document.getElementById("submitIntake");
      const form = document.getElementById("intakeForm");
      chipButtons.forEach((chip) => {
        chip.addEventListener("click", (e) => {
          e.preventDefault();
          chip.classList.toggle("active");
        });
      });
      submitBtn.addEventListener("click", (e) => {
        e.preventDefault();
        if (!form.reportValidity()) return;
        alert("✓ Request submitted successfully!");
        form.reset();
        chipButtons.forEach(c => c.classList.remove("active"));
      });
    }

    function initQueuePage() {
      const tbody = document.querySelector("#queueTable tbody");
      const statusFilter = document.getElementById("filterStatus");
      const deptFilter = document.getElementById("filterDepartment");
      const engagementFilter = document.getElementById("filterEngagement");
      function renderTable() {
        const statusVal = statusFilter.value;
        const deptVal = deptFilter.value;
        const engVal = engagementFilter.value;
        tbody.innerHTML = "";
        dummyRequests.filter((req) => statusVal === "all" || req.status === statusVal).filter((req) => deptVal === "all" || req.department === deptVal).filter((req) => engVal === "all" || req.engagement === engVal).forEach((req) => {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td><strong>${req.id}</strong></td><td>${req.requester}</td><td>${req.organization}</td><td>${req.engagement}</td><td>${deptMap[req.department]}</td><td><span class="status-pill status-${req.status}">${req.status.replace("-", " ").toUpperCase()}</span></td><td>${req.assignedTo || "Unassigned"}</td>`;
          tbody.appendChild(tr);
        });
      }
      statusFilter.addEventListener("change", renderTable);
      deptFilter.addEventListener("change", renderTable);
      engagementFilter.addEventListener("change", renderTable);
      renderTable();
    }

    function initResponsesPage() {
      const list = document.getElementById("responseRequestList");
      const detailEmpty = document.getElementById("responseDetailEmpty");
      const detailPanel = document.getElementById("responseDetail");
      const elRequester = document.getElementById("detailRequester");
      const elEngagement = document.getElementById("detailEngagement");
      const elDept = document.getElementById("detailDept");
      const elAssigned = document.getElementById("detailAssigned");
      const elStatus = document.getElementById("detailStatus");
      const elResponses = document.getElementById("detailResponses");
      const elSurvey = document.getElementById("detailSurvey");
      dummyRequests.forEach((req) => {
        const li = document.createElement("li");
        li.className = "request-list-item";
        li.innerHTML = `<div class="request-title">${req.requester}</div><div class="request-meta">${req.organization}</div><div class="request-meta">${req.engagement} • ${req.preferredDate}</div>`;
        li.addEventListener("click", () => selectRequest(req, li));
        list.appendChild(li);
      });
      function selectRequest(req, li) {
        list.querySelectorAll(".request-list-item.active").forEach((n) => n.classList.remove("active"));
        li.classList.add("active");
        detailEmpty.classList.add("hidden");
        detailPanel.classList.remove("hidden");
        elRequester.textContent = req.requester + " (" + req.email + ")";
        elEngagement.textContent = req.engagement + " – " + req.organization;
        elDept.textContent = deptMap[req.department];
        elAssigned.textContent = req.assignedTo || "Unassigned";
        elStatus.innerHTML = `<span class="status-pill status-${req.status}">${req.status.replace("-", " ").toUpperCase()}</span>`;
        elResponses.innerHTML = "";
        if (req.responses.length === 0) {
          elResponses.innerHTML = "<li><em>No responses logged yet.</em></li>";
        } else {
          req.responses.forEach((r) => {
            const liResp = document.createElement("li");
            liResp.innerHTML = `<strong>${r.date}</strong> by ${r.by}<br><em>${r.text}</em>`;
            elResponses.appendChild(liResp);
          });
        }
        if (req.survey.status === "Completed") {
          elSurvey.innerHTML = `<strong>Status:</strong> Completed<br><strong>Score:</strong> ${req.survey.score}/5.0`;
        } else if (req.survey.status === "Pending") {
          elSurvey.textContent = "Survey pending – will be sent after completion.";
        } else {
          elSurvey.textContent = "Survey not yet scheduled.";
        }
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      const navTabs = document.querySelectorAll(".nav-tab");
      navTabs.forEach((tab) => {
        tab.addEventListener("click", () => {
          navTabs.forEach(t => t.classList.remove("active"));
          tab.classList.add("active");
          renderPage(tab.dataset.page);
        });
      });
      renderPage("intake");
    });

    function refreshAnalytics() {
      const startDate = document.getElementById('startDate').value;
      const endDate = document.getElementById('endDate').value;
      alert('Analytics updated for: ' + startDate + ' to ' + endDate);
    }

    function exportReport() {
      alert('Export feature: PDF report would be generated with all metrics and charts.');
    }
  </script>
</body>
</html>
